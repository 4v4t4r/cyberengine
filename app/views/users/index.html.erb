<% content_for :header do "#{@service.name} Users" end %>

<% if can? :new, User %>
  <% content_for :actions do %>
    <% if can? :new, User %>
      <li class="new"> 
        <%= link_to new_team_server_service_user_path(@team,@server,@service) do %>New User<i class="icon-plus-sign"></i><% end %>
      </li>
    <% end %>  
  <% end %>  
<% end %> 

<% content_for :crumbs do %>
  <li class='crumb'>
    <%= link_to team_path(@team) do %>Team<i class="icon-chevron-left"></i><% end %>
  </li>
  <li class='crumb'>
    <%= link_to team_servers_path(@team) do %>Servers<i class="icon-chevron-left"></i><% end %>
  </li>
  <li class='crumb'>
    <%= link_to team_server_path(@team,@server) do %>Server<i class="icon-chevron-left"></i><% end %>
  </li>
  <li class='crumb'>
    <%= link_to team_server_services_path(@team,@server) do %>Services<i class="icon-chevron-left"></i><% end %>
  </li>
  <li class='crumb'>
    <%= link_to team_server_service_path(@team,@server,@service) do %>Service<i class="icon-chevron-left"></i><% end %>
  </li>
<% end %>


<% service = @service if @service %>
<% users = service.users.order('updated_at DESC') %>

<table class="table table-bordered table-hover">
  <thead>
    <tr>
      <th>Updated At</th>
      <th>Username</th>
      <th>Password</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <% if users.count == 0 %>
      <tr>
        <td colspan="4">No Users</td>
      </tr>
    <% else %>
      <% users.each do |user| %>
        <tr>
          <td><%= user.updated_at %></td>
          <td><%= user.username %></td>
          <td><%= user.password %></td>
          <td>
            <%= link_to "Show", team_server_service_user_path(@team,@server,service,user), class: "btn btn-small" if can? :show, user%>
            <%= link_to "Edit", edit_team_server_service_user_path(@team,@server,service,user), class: 'btn btn-small' if can? :edit, user %>
            <%= link_to 'Delete', team_server_service_user_path(@team,@server,service,user), class: 'btn btn-small btn-danger', method: :delete, data: { confirm: 'Please Confirm' } if can? :destroy, user %>
          </td>

        </tr>
      <% end %>
    <% end %>
  </tbody>
</table>
